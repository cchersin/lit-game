{"version":3,"file":"player-list.js","sourceRoot":"","sources":["../../src/player-list.ts"],"names":[],"mappings":";AAAA,OAAO,EAAE,UAAU,EAAE,IAAI,EAAE,GAAG,EAAE,MAAM,KAAK,CAAC;AAC5C,OAAO,EAAE,QAAQ,EAAE,aAAa,EAAE,MAAM,mBAAmB,CAAC;AAE5D,OAAO,EAAE,EAAE,EAAE,MAAM,eAAe,CAAC;AACnC,OAAO,EAAE,UAAU,EAAE,SAAS,EAAE,GAAG,EAAE,KAAK,EAAE,OAAO,EAAE,UAAU,EAAa,MAAM,oBAAoB,CAAC;AAEvG,OAAO,EAAE,mBAAmB,EAAE,MAAM,UAAU,CAAC;AAC/C,OAAO,EAAE,EAAE,EAAE,MAAM,iBAAiB,CAAC;AAErC,OAAO,kBAAkB,CAAC;AAGnB,IAAM,UAAU,GAAhB,MAAM,UAAW,SAAQ,UAAU;IASxC;QACE,KAAK,EAAE,CAAC;QATiB,UAAK,GAAmF,EAAE,CAAC;QAUpH,IAAI,CAAC,SAAS,EAAE,CAAC;IACnB,CAAC;IAED,KAAK,CAAC,SAAS;QACb,MAAM,CAAC,GAAG,KAAK,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,CAAC,EAAE,OAAO,CAAC,eAAe,CAAC,CAAC,CAAC;QACnE,UAAU,CAAC,CAAC,EAAE,CAAC,aAAa,EAAE,EAAE;YAC9B,IAAI,CAAC,KAAK,GAAG,aAAa,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE;gBACxC,MAAM,IAAI,GAAG,GAAG,CAAC,IAAI,EAGpB,CAAC;gBAEF,MAAM,mBAAmB,GAAG,mBAAmB,CAAC,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,EAAE,CAAC,CAAA;gBAG7G,OAAO;oBACL,GAAG,IAAI;oBACP,mBAAmB,EAAE,mBAAmB;iBACzC,CAAC;YACJ,CAAC,CAAC,CAAC;YAGH,IAAI,CAAC,aAAa,EAAE,CAAC;QACvB,CAAC,CAAC,CAAC;IACL,CAAC;IAED,kBAAkB,CAAC,KAAU;QAC1B,MAAM,SAAS,GAAG,GAAG,CAAC,EAAE,EAAE,OAAO,EAAE,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QACtD,SAAS,CAAC,SAAS,CAAC,CAAC;IACxB,CAAC;IAED,MAAM;QACJ,OAAO,IAAI,CAAA;;;UAGL,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAA;+BACN,IAAI,CAAC,IAAI,kBAAkB,IAAI,CAAC,mBAAmB,qBAAqB,IAAI,CAAC,kBAAkB;UACpH,CAAC;;GAER,CAAC;IACF,CAAC;;AAhDM,iBAAM,GAAG,GAAG,CAAA;;;;GAIlB,AAJY,CAIX;AANyB;IAA1B,QAAQ,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC;yCAA4F;AAD3G,UAAU;IADtB,aAAa,CAAC,aAAa,CAAC;GAChB,UAAU,CAoDtB","sourcesContent":["import { LitElement, html, css } from 'lit';\nimport { property, customElement } from 'lit/decorators.js';\n\nimport { db } from './firebase.js';\nimport { collection, deleteDoc, doc, query, orderBy, onSnapshot, Timestamp } from 'firebase/firestore';\n\nimport { formatDistanceToNow } from \"date-fns\";\nimport { it } from \"date-fns/locale\";\n\nimport './player-card.js';\n\n@customElement('player-list')\nexport class PlayerList extends LitElement {\n  @property({ type: Array }) users: Array<{ name: string, lastOnlineRef: Timestamp, lastOnlineFormatted: string }> = [];\n \n  static styles = css`\n  .users {\n    border: 1px solid blue;\n  }\n  `;\n\n  constructor() {\n    super();\n    this.loadUsers();\n  }\n\n  async loadUsers() {\n    const q = query(collection(db, \"users\"), orderBy(\"lastOnlineRef\"));\n    onSnapshot(q, (querySnapshot) => {\n      this.users = querySnapshot.docs.map(doc => {\n        const data = doc.data() as { \n          name: string, \n          lastOnlineRef: Timestamp \n        };\n\n        const lastOnlineFormatted = formatDistanceToNow(data.lastOnlineRef.toDate(), { addSuffix: true, locale: it })\n\n\n        return {\n          ...data,\n          lastOnlineFormatted: lastOnlineFormatted\n        };\n      });\n\n\n      this.requestUpdate();\n    });\n  }\n\n  handlePlayerDelete(event: any) {\n     const playerDoc = doc(db, \"users\", event.detail.name);  \n     deleteDoc(playerDoc);\n  }\n\n  render() {\n    return html`\n       <div class=\"users\">\n        Players:\n        ${this.users.map(user => html`\n          <player-card name=\"${user.name}\" lastOnline= \"${user.lastOnlineFormatted}\" @player-delete=\"${this.handlePlayerDelete}\"/>\n         `)}\n       </div>   \n  `;\n  }\n}\n"]}