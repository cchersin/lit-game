{"version":3,"file":"login.js","sourceRoot":"","sources":["../../src/login.ts"],"names":[],"mappings":"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","sourcesContent":["import { LitElement, html, css } from 'lit';\nimport { property, customElement } from 'lit/decorators.js';\n\nimport { auth, db } from './firebase.js';\nimport { signInAnonymously, User, updateProfile } from 'firebase/auth';\nimport { setDoc, doc } from 'firebase/firestore';\n\nimport { Router } from '@vaadin/router';\n\n\n@customElement('user-login')\nexport class Login extends LitElement {\n  @property({ type: String }) displayName = localStorage.userName ? localStorage.userName : ''; \n \n  static styles = css`\n  .login {\n    overflow: hidden;\n    background-color: red;\n    height: 100%;\n  }\n\n  .input-label {\n    text-align: center;\n    font-weight: bold;\n    font-size: 15px;\n    padding-top: 100px;\n  }\n \n  .input-container {\n    margin-top: 10px;\n    width: 100%;\n  }\n\n  .input-container2 {\n    margin: auto;\n    width: 79%;\n  }\n\n  .input-container3 {\n    margin: auto;\n    width: 20%;\n  }\n\n  .input-container input {\n    border-radius: 12px;\n    border: 2px solid black;\n    height: 60px;\n    width: 100%;\n    text-align: center;\n    font-size: 50px;\n    padding-bottom: 10px;\n    font-family: \"gandur-new\", sans-serif;\n    font-weight: 600;\n    font-style: normal;\n    background-color: red;\n    text-transform: capitalize;\n  }\n\n  .input-container input::placeholder {\n    color: darkred;\n    font-weight: 600;\n    text-transform: none;\n  }\n\n  .input-container input:focus {\n    outline: none;\n  }\n\n  .input-container button {\n    padding: 5px 10px;\n    border: 2px solid black;\n    border-radius: 12px;\n    background-color: red;\n    margin-top: 30px;\n  }\n  `;\n\n  private user: User | null = null;\n  \n  constructor() {\n    super();\n    if (this.displayName) {\n      this.signInAnonymously();\n    }\n  }\n\n  async signInAnonymously(): Promise<void> {\n  \n    try {\n      const userCredential = await signInAnonymously(auth);\n      this.user = userCredential.user;\n      console.log(\"Signed in anonymously:\", this.user.uid);\n      if (this.user) {\n        await updateProfile(this.user, {\n          displayName: this.displayName\n        });\n       \n        const userDoc = doc(db, \"users\", this.displayName);\n        const data = {\n          name: this.displayName,\n          sessionId: this.user.uid,\n          lastOnlineRef: new Date(),\n        };\n\n        await setDoc(userDoc, data);\n\n        localStorage.userName  = data.name;\n        localStorage.sessionId = data.sessionId;\n     \n        Router.go('/starting');\n      } else {\n        console.warn(\"No user is currently signed in.\");\n      }\n\n      this.requestUpdate(); \n    } catch (error: any) {\n      console.error(\"Anonymous auth failed:\", error);\n      // Handle errors more gracefully!\n    }\n  }\n \n  handleInputDisplayName(event: Event) {\n    const input = event.target as HTMLInputElement;\n    this.displayName = input.value;\n  }\n\n  render() {\n    return html`\n      <div class=\"login\">\n        <p class=\"input-label\">E tu chi saresti???</p>\n         <div class=\"input-container\">\n          <div class=\"input-container2\">\n            <input type=\"text\" .value=\"${this.displayName}\" @input=\"${this.handleInputDisplayName}\" maxlength=\"6\" placeholder=\"Io sono...\"/>\n          </div>\n          <div class=\"input-container3\">\n            <button @click=\"${this.signInAnonymously}\">Login</button>\n          </div>\n         </div>\n      </div>\n    `;\n  }\n}\n"]}