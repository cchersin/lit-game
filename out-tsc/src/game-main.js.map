{"version":3,"file":"game-main.js","sourceRoot":"","sources":["../../src/game-main.ts"],"names":[],"mappings":"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","sourcesContent":["import { LitElement, html, css } from 'lit';\nimport { property, customElement } from 'lit/decorators.js';\n\nimport { Router } from '@vaadin/router';\n\nimport './game-card.js';\nimport { Card } from './card.js'\nimport { Game } from './game.js';\nimport { StoreService } from './store-service.js';\nimport { ht } from 'date-fns/locale';\n\n@customElement('game-main')\nexport class GameMain extends LitElement {\n  currentCardId = '';\n  currentGame = new Game('');\n  \n  static styles = css`\n  main {\n    overflow: hidden;\n    background-color: black;\n    height: 100%;\n  }\n\n  .card {\n    border: 1px solid #ccc;\n    padding: 10px;\n    border-radius: 5px;\n  }\n\n  .player-widget {\n    background-color: white;\n    padding: 5px;\n    padding-left: 10px;\n    padding-right: 10px;\n    border-radius: 20px;\n    margin: 20px;\n  }\n\n  .master-widget {\n    background-color: red;\n    color: black;\n    padding: 5px;\n    padding-left: 10px;\n    padding-right: 10px;\n    border-radius: 20px;\n    margin: 20px;\n  }\n\n  .container-cards {\n   position: relative;\n  }\n\n  .container-widget {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    align-content: center;\n    flex-wrap: wrap;\n    max-width: 400px;\n    margin: auto;\n  }\n  \n  .action-button {\n    background-color: red;\n    font-size: 18px;\n    border-radius: 20px;\n    z-index: 1000;\n    position: relative;\n    border: none;\n    padding: 10px;\n    padding-left: 18px;\n    padding-right: 18px;\n    font-weight: bold;\n    margin: 10px;\n    margin-top: 30px;\n  }\n  `;\n\n  constructor() {\n    super();\n    this.loadGame();\n  }\n\n  handleCardClick(event: any) {\n    this.currentCardId = event.detail.id;\n    this.requestUpdate();\n  }\n\n  findCardContent(cardId: String) {\n    var cards = this.getRole() === 'player' ? this.getHand() : this.currentGame.tableCards;\n    const card = cards.find((c: any) => c.id === cardId);\n\n    if (card) {\n      return card.content;\n    }\n\n    return '';\n  }\n\n  handleStopGame(event: any) {\n    console.log('handleStopGame');\n    this.currentGame.stop();\n    StoreService.saveGame(this.currentGame);\n    this.requestUpdate();\n  }\n\n  handleLeaveGame() {\n    this.currentGame.leave(localStorage.userName);\n    StoreService.saveGame(this.currentGame);\n    Router.go('/'); \n  }\n\n  loadGame() {\n    StoreService.onGameUpdate((game) => {\n        this.currentGame = game;\n\n        if (this.currentGame.status !== 'started' || !this.hasRole()) {\n          Router.go('/starting');\n        }\n\n        if (this.currentGame.status === 'completed') {\n          Router.go('/winner');\n        }\n\n        if (this.getPlayer()?.hasCards() && !this.getPlayer()?.hasCard(this.currentCardId)) {\n          this.currentCardId = '';\n        }\n   \n        this.requestUpdate();\n    });\n  }\n\n  findMasterName() {\n    return this.currentGame.findMasterName();\n  }\n\n  findPlayers() {\n    return this.currentGame.findPlayers();\n  } \n\n  isMaster() {\n    return this.currentGame.isMaster(localStorage.userName);\n  }\n\n  isPlayer() {\n    return this.currentGame.isPlayer(localStorage.userName);\n  }\n\n  getPlayer() {\n    return this.currentGame.getPlayer(localStorage.userName);\n  }\n\n  hasRole() {\n    return this.getPlayer();\n  }\n\n  hasHand() {\n    const player = this.currentGame.getPlayer(localStorage.userName);\n    return player ? player.hand.length > 0 : false;\n  }\n\n  getRole() {\n    return this.currentGame.getRole(localStorage.userName);\n  }\n\n  renderBlackCard() {\n    if (!this.hasRole()) {\n      return html``; \n    }\n\n    let left = 0;\n    let zindex = 11;\n   \n    return html`<game-card description=\"${this.currentGame.blackCard?.content}\" value=\"${this.findCardContent(this.currentCardId)}\" backgroundColor=\"${this.currentGame.blackCard?.color}\" color=\"${this.currentGame.blackCard?.getOppositeColor()}\"></game-card>`;\n  }\n\n  getHand() {\n    return this.currentGame.getHand(localStorage.userName);\n  }\n\n  getRounds() {\n    return this.currentGame.rounds;\n  }\n\n  handlePlayCard() {\n    this.currentGame.playCard(localStorage.userName, this.currentCardId);\n\n    StoreService.saveGame(this.currentGame);\n  }\n\n  renderWhiteCards() {\n    if (this.getRole() === 'player') {\n      return this.renderCards(this.getHand());\n    } else {\n      return this.renderCards(this.currentGame.tableCards);\n    }\n  }\n\n\n  renderCards(cards: any) {\n    let left = -60;\n    let zindex = 11;\n   \n    return html`<div class=\"container-cards\">\n         ${cards.map((card: any) => \n              new Card(card.id, card.content, card.color)).map((card: any) => { \n                left += 40;\n                zindex -= 1;\n                return html`\n            <game-card id=\"${card.id}\" description=\"${card.content}\" backgroundColor=\"${card.color}\" color=\"${card.getOppositeColor()}\" left=\"${left}px\" zindex=\"${zindex}\" isselected=\"${card.id === this.currentCardId}\"></game-card>\n          `})}\n        </div>`;\n  }\n\n\n  renderRounds() {\n    return html`<div>\n         ${this.getRounds().map((round: any) => {\n          return html`<div>\n            winner:${round.winnerName} ${round.sentence} \n          </div>`})}\n        </div>`;\n  }\n\n\n  render() {\n     return html`\n      <main class=\"game\" @game-card-click=${this.handleCardClick}>\n        <span>User: ${localStorage.userName}(${this.getRole()}) - ${this.currentGame.status}</span>\n        <div class=\"container-widget\">\n          <span class=\"master-widget\">${this.findMasterName()} ${this.currentGame.getPlayerWins(this.findMasterName())}</span>\n          ${this.findPlayers().map(player => html`\n            <span class=\"player-widget\">\n              ${player.name} ${player.currentCardId !== '' ? html`has choosen` : html``} ${this.currentGame.getPlayerWins(player.name)}\n            </span>\n          `)}\n        </div>\n         ${this.renderBlackCard()} \n         ${this.getPlayer()?.currentCardId === '' ? this.renderWhiteCards() : html `<div style=\"color:white\">wait...</div>`}\n         <div class=\"container-widget\">\n          ${this.getPlayer()?.currentCardId === '' && this.currentCardId !== '' ? html`<button class=\"action-button\" @click=\"${this.handlePlayCard}\">Confirm</button>` : html``}\n          ${this.currentGame.status === 'started' ? html`<button class=\"action-button\" @click=\"${this.handleStopGame}\">Stop</button>` : html``}\n          <button class=\"action-button\" @click=\"${this.handleLeaveGame}\">Leave</button>\n         </div>  \n         ${this.renderRounds()} \n      </main>\n    `;\n  }\n}\n"]}